var reviewData="loading";String.prototype.trunc=function(n,useWordBoundary){if(this.length<=n){return this;}
var subString=this.substr(0,n-1);return(useWordBoundary?subString.substr(0,subString.lastIndexOf(' ')):subString)+"&hellip;";};function chk_scroll(e){var elem=$(e.currentTarget);if(elem[0].scrollWidth-elem.scrollLeft()==elem.outerWidth()){console.log("right");$('.see-more-reviews').fadeOut("slow");}
else{$('.see-more-reviews').fadeIn("slow");}}
$.get("https://api.reviews.co.uk/merchant/latest?store=craft-clubs",function(data){reviewData=data;console.log(reviewData);var reviewWord=reviewData.word;var reviewAverage=reviewData.stats.average_rating;var reviewAmount=reviewData.stats.total_reviews;var reviewPercentage=reviewAverage*2*10;$('.filler').attr('style','width: calc('+reviewPercentage+'% - 4.95%) !important');console.log(reviewPercentage);$('.review-word').html(reviewWord);$('.review-average span').html(reviewAverage);$('.review-amount span').html(reviewAmount);for(let key in reviewData.reviews){let comments=reviewData.reviews[key].comments;if(comments.indexOf("LL-")<=0){var i=0;function starBoy(){if(i<rating){$('.review'+key+' .star-holder').append('<div class="review-star">â˜…</div>');i++;starBoy();}}
$('.review-row').append('<div class="review review'+key+'"><div class="star-holder"></div></div>');var rating=reviewData.reviews[key].rating;starBoy();var author=reviewData.reviews[key].reviewer.first_name+" "+reviewData.reviews[key].reviewer.last_name;$('.review'+key).prepend("<p class='reviewer'>"+author+"</p>");$('.review'+key).append('<p class="review-text">'+comments.trunc(300,true)+'</p>');let date=reviewData.reviews[key].date;$('.review'+key).append('<p class="date">Posted '+date+'</p>');$('.review-stats, .review-row').removeClass('hidden');}}});function sideScroll(element,direction,speed,distance,step){scrollAmount=0;var slideTimer=setInterval(function(){if(direction=='left'){element.scrollLeft-=step;}else{element.scrollLeft+=step;}
scrollAmount+=step;if(scrollAmount>=distance){window.clearInterval(slideTimer);}},speed);}
$('#review-fest').bind('scroll',chk_scroll);$('.see-more-reviews').click(function(){var scrollDistance=window.outerWidth/1.56;if(scrollDistance>1076){scrollDistance=320;}
if(window.outerWidth<575){scrollDistance=window.outerWidth*0.75-20;console.log('reduced scroll distance'+scrollDistance);}
var reviewContainer=document.getElementById('review-fest');var iOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(iOS==true){sideScroll(reviewContainer,'right',10,scrollDistance,10);}else{document.getElementById('review-fest').scrollLeft+=scrollDistance;}})